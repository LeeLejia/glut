(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],p=0,d=[];p<o.length;p++)r=o[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={app:0},s=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/pages/glut-panel/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"1a27":function(t,e,n){},"1b97":function(t,e,n){},"1f07":function(t,e,n){"use strict";var a=n("4e00"),i=n.n(a);i.a},"3c82":function(t,e,n){"use strict";var a=n("1a27"),i=n.n(a);i.a},"42cf":function(t,e,n){},"4e00":function(t,e,n){},"5c0b":function(t,e,n){"use strict";var a=n("e332"),i=n.n(a);i.a},9194:function(t,e,n){"use strict";var a=n("1b97"),i=n.n(a);i.a},a57c:function(t,e,n){"use strict";var a=n("b63c"),i=n.n(a);i.a},a5d2:function(t,e,n){},ac53:function(t,e,n){"use strict";var a=n("f04a"),i=n.n(a);i.a},b63c:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"font-normal",attrs:{id:"app"}},[t.groupIdValid?n("Panel"):n("InputGroupId",{on:{updateConfig:t.checkGroupId}})],1)},s=[],r=n("d225"),o=n("b0b4"),c=n("308d"),l=n("6bb5"),u=n("4e2b"),p=n("9ab4"),d=n("60a3"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"groupId-input-container"},[n("div",{staticClass:"title f-normal"},[t._v("通过设置 GroupId 获取你的 Glut 应用")]),n("div",{staticClass:"input-box flex-row"},[n("i-input",{staticClass:"groupid-input",attrs:{icon:"ios-help-circle-outline",placeholder:"请设定GroupId",autocomplete:""},on:{"on-click":t.question},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}}),n("i-button",{attrs:{type:"primary",shape:"circle",loading:t.handle},on:{click:t.confirm}},[t._v("OK")])],1)])},g=[],m=n("01f8"),h=n("2d66"),v=n("a8ee"),b=n("117e"),y=(n("8e6e"),n("456d"),n("75fc")),_=(n("5df3"),n("8615"),n("ac6a"),n("7f7f"),n("bd86"));function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(n,!0).forEach(function(e){Object(_["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var I=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];return new Promise(function(e){chrome.runtime.sendMessage({type:"invoke",name:t,args:n},e)})};function k(t){I("notice","",O({type:"basic",iconUrl:"assets/img/app-icon.png"},t))}var j=function(t){return console.log("load app:",t.key),I("loadApp",t.key).then(function(e){if(0!==e.status)return k({title:"下载App失败",message:"key:".concat(t.key||"")}),console.log("load app failed[".concat(t.key,"]: status=").concat(e.status)),{status:-1,msg:"下载App失败:".concat(t.key)};console.log("load app success:",t.key);var n=e.result||{};return console.log("load app: ",n),I("fetch",n.script).then(function(e){var n=e.result;0===n.status&&(k({title:"下载App成功",message:"[".concat(n.result&&n.result.name||"","] ").concat(n.result&&n.result.desc||"")}),localStorage.setItem("APP#SCRIPT#"+t.key,n.result))}),{status:0,data:{id:n.objectId,desc:n.desc,name:n.name,icon:n.icon||"",script:n.script,lastTime:t.lastTime}}}).catch(function(t){return{status:-1,msg:t}})},w=function(){var t,e=new Promise(function(e){return t=e}),n=JSON.parse(localStorage.getItem("LIST#APP")||"[]")||[];return chrome.storage&&chrome.storage.sync.get({AppList:[]},function(e){var a=e.AppList,i=n||[],s=a.reduce(function(t,e){return t[e.key]=e,t},{});i.forEach(function(t){var e=s[t.id];if(!e||e.lastTime!==t.lastTime)return t.delete=!0,console.log("remove app:",t.id),void localStorage.removeItem("APP#SCRIPT#"+t.id);e.avoidLoad=!0});var r=Object.values(s).filter(function(t){return!t.avoidLoad}).map(function(t){return j(t)});Promise.all(r).then(function(e){var n=e.map(function(t){return t.data}),a=[].concat(Object(y["a"])(i.filter(function(t){return!t.delete})),Object(y["a"])(n));localStorage.setItem("LIST#APP",JSON.stringify(a)),t&&t(a)})}),e};function x(t){chrome.tabs.query({active:!0,currentWindow:!0},function(e){t&&t(e.length?e[0]:null)})}var $={RMI:I,getAppList:w,getCurrentTab:x,loadApp:j};chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return""},set:function(t,e){return e()}}});var A=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.groupId="",t.handle=!1,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;chrome.storage.sync.get({groupId:""},function(e){t.groupId=e.groupId})}},{key:"question",value:function(){this.$notice.open({title:"获取GroupId",render:function(t){return t("span",["选择以下方式 ",t("a",{attrs:{href:"https://leelejia.github.io/sites/glut/?page=getId",target:"_blank"}},"通过邮箱查询")," 或 ",t("a",{attrs:{href:"https://leelejia.github.io/sites/glut/?page=regiest",target:"_blank"}},"注册GroupId")," 获取GroupId"])},duration:15e3})}},{key:"confirm",value:function(){var t=this;if(this.groupId.trim()){this.handle=!0;var e=this.$message.loading({content:"同步配置中...",duration:0});$.RMI("updateConfig",this.groupId.trim()).then(function(n){if(e(),t.handle=!1,0!==n.status)return t.$message.error(n.result||"请输入有效的GroupId"),void t.$emit("updateConfig",!1);t.$message.success("设置成功！"),t.$emit("updateConfig",!0)})}else this.$message.error("请输入先groupId")}},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]);A=p["a"]([Object(d["a"])({components:{"i-input":h["a"],"i-button":m["a"]}})],A);var S=A,P=S,U=(n("a57c"),n("2877")),N=Object(U["a"])(P,f,g,!1,null,null,null),M=N.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel-container flex-column"},[t.groupName?n("div",{staticClass:"group-name f-normal"},[t._v("Group: "+t._s(t.groupName))]):t._e(),n("Menu",{attrs:{mode:"horizontal",theme:"light","active-name":t.selectTab},on:{"on-select":function(e){return t.selectTab=e}}},[n("MenuItem",{attrs:{name:"apps"}},[n("Icon",{attrs:{type:"ios-apps"}}),t._v("应用\n    ")],1),n("MenuItem",{attrs:{name:"script-manage"}},[n("Icon",{attrs:{type:"logo-javascript"}}),t._v("开发管理\n    ")],1),n("MenuItem",{attrs:{name:"setting"}},[n("Icon",{attrs:{type:"md-hammer"}}),t._v("设置\n    ")],1)],1),n("div",{staticClass:"content"},["apps"===t.selectTab?n("menuApp"):"script-manage"===t.selectTab?n("menuDev"):"setting"===t.selectTab?n("menuSetting"):t._e()],1)],1)},T=[],L=n("d3b2"),G=n("bf7a"),D=n("9e6d"),E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"apps-container flex-column"},[n("div",{staticClass:"app-list"},t._l(t.appList,function(e){return n("div",{key:e.id,staticClass:"item flex-column active-scale",on:{"!click":function(n){return t.onAppClick(e)}}},[n("Tooltip",{attrs:{"max-width":"200",content:e.desc,delay:400}},[n("div",{staticClass:"icon-container"},[e.loadding?n("Spin",{staticClass:"spin",attrs:{fix:""}}):t._e(),e.icon?n("img",{staticClass:"app-icon",attrs:{src:e.icon}}):n("div",{staticClass:"app-icon app-no-icon",style:{backgroundColor:"hsl("+Math.ceil(361*Math.random())+",60%, 70%)"}},[t._v(t._s((e.name||" ")[0]))])],1),n("div",{staticClass:"name f-ellipsis"},[t._v(t._s(e.name))])])],1)}),0),t.appList&&0!==t.appList.length?t._e():n("div",{staticClass:"empty flex-row"},[t._v("当前没有应用")]),n("div",{staticClass:"version"},[t._v("\n    "+t._s(t.version)+" @\n    "),n("a",{attrs:{href:"https://github.com/LeeLejia/glut",target:"_blank"}},[t._v("开源代码")])])])},z=[],B=n("7d1f"),J=n("ff8e"),F=(n("f559"),{extBasePath:chrome.extension&&chrome.extension.getURL("")});function H(t,e){return"\n  if (!window.$chromeMiniApps) {\n    // 构建通信通道\n    (()=>{\n      const temp = document.createElement('script');\n      temp.setAttribute('type', 'text/javascript');\n      temp.innerHTML = `\n        window.addEventListener('message', ({data})=>{\n          if(typeof data !== 'object' || data.type !== 'glut-inject' || !data.id || !data.script) {\n            return;\n          }\n          Promise.resolve().then(()=>{\n            return eval(data.script)\n          }).catch(err=>({\n            status: -1,\n            msg: err\n          })).then(res=>({\n            status: 0,\n            data: res\n          })).then(res=>{\n            postMessage({\n              id: data.id,\n              type: 'glut-window',\n              data: res\n            });\n          }).catch(err=>{\n            postMessage({\n              id: data.id,\n              type: 'glut-window',\n              data: {\n                status: -1,\n                msg: '不能传递不能clone的对象'\n              }\n            });\n          });\n        })\n      `;\n      temp.onload = function () {\n        this.parentNode.removeChild(this);\n      };\n      document.body.appendChild(temp);\n    })();\n    const url = '".concat(F.extBasePath,"js/inject.js';\n    fetch(url).then(res=>res.text()).then(code=>{\n      eval(code);\n      window.$glutInitApp(JSON.parse('").concat(JSON.stringify(t),"'), JSON.parse('").concat(JSON.stringify(F),"')).then(isRun => {\n        if (isRun) {\n          ").concat(e,";\n          const __appConfig = window.$chromeMiniApps && window.$chromeMiniApps['").concat(t.id,"'];\n          __appConfig.lifeCycle && __appConfig.lifeCycle.open && __appConfig.lifeCycle.open();\n        }\n      })\n    })\n  } else {\n    console.warn('[glut]脚本已经存在！')\n    window.$glutInitApp(JSON.parse('").concat(JSON.stringify(t),"'), JSON.parse('").concat(JSON.stringify(F),"')).then(isRun => {\n      if (isRun) {\n        ").concat(e,";\n        const __appConfig = window.$chromeMiniApps && window.$chromeMiniApps['").concat(t.id,"'];\n        __appConfig.lifeCycle && __appConfig.lifeCycle.open && __appConfig.lifeCycle.open();\n      }\n    })\n  }\n  ")}var V={version:"v1.0.4",time:"2019/12/11"};chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return""},set:function(t,e){return e()}}});var q=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.groupId="",t.handle=!1,t.appList=[],t.version=V.version,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;$.getAppList().then(function(e){t.appList=e}),chrome.storage.sync.get({groupId:""},function(e){t.groupId=e.groupId})}},{key:"onAppClick",value:function(t){var e=this;t.loadding||$.getCurrentTab(function(n){if(console.log("tab:",n),n.url.startsWith("chrome")||n.url.startsWith("file://"))e.$message.warning("不能在该页面加载小程序");else{var a="APP#SCRIPT#".concat(t.id),i=localStorage.getItem(a);i?chrome.tabs.executeScript(n.id,{code:H(t,i)}):(console.log("[APP] ".concat(t.name," 不存在，开始重新加载.").concat(new Date)),e.$message.warning("第一次加载「".concat(t.name,"」较慢，请耐心等待")),t.loadding=!0,e.appList=Object(y["a"])(e.appList),$.RMI("fetch",t.script).then(function(i){if(console.log("[APP] 「".concat(t.name,"」下载结果：").concat(0===i.status,".").concat(new Date)),t.loadding=!1,e.appList=Object(y["a"])(e.appList),0===i.status){localStorage.setItem(a,i.result);var s=i.result;s&&chrome.tabs.executeScript(n.id,{code:H(t,s)})}else e.$message.warning("「".concat(t.name,"」加载失败，请稍后重试"))}))}})}},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]);q=p["a"]([Object(d["a"])({components:{"i-input":h["a"],"i-button":m["a"],Spin:J["a"],Tooltip:B["a"]}})],q);var W=q,K=W,Z=(n("3c82"),Object(U["a"])(K,E,z,!1,null,null,null)),Q=Z.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dev-container flex-row"},[n("RadioGroup",{staticClass:"mode-selector",attrs:{vertical:""},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}},[n("Radio",{attrs:{label:"dev"}},[n("Icon",{attrs:{type:"ios-bug"}}),n("span",[t._v("调试")])],1),n("Radio",{attrs:{label:"publish"}},[n("Icon",{attrs:{type:"md-cloud-upload"}}),n("span",[t._v("发布")])],1)],1),n("div",{staticClass:"content"},["dev"===t.mode?n("devPart",{staticClass:"dev"}):"publish"===t.mode?n("uploadPart",{staticClass:"upload"}):t._e()],1)],1)},Y=[],tt=n("a49b"),et=n("10aa"),nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dev-form-container flex-column"},[n("div",{staticClass:"info"},[n("RadioGroup",{staticClass:"type-selector",model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("Radio",{attrs:{label:"link"}},[t._v("链接")]),n("Radio",{attrs:{label:"file"}},[t._v("文件")])],1),n("i-input",{staticClass:"link-input",attrs:{size:"small",disabled:"link"!==t.type,placeholder:"请输入脚本链接"},model:{value:t.inputUrl,callback:function(e){t.inputUrl=e},expression:"inputUrl"}}),n("Upload",{staticClass:"file-input",attrs:{disabled:"file"!==t.type||"file"===t.type&&t.loadding,"before-upload":t.onFile,accept:"text/javascript, application/javascript"}},[n("Button",{attrs:{loading:t.loadding,size:"small",disabled:"file"!==t.type,icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.fileName||"上传脚本"))])],1)],1),n("Button",{attrs:{size:"primary",loading:t.loadding,icon:"ios-bug"},on:{click:t.debug}},[t._v("调试")])],1)},at=[],it=n("e9ce"),st=(n("96cf"),n("3b8d")),rt=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.type="link",t.inputUrl="",t.fileName="",t.fileText="",t.loadding=!1,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;chrome.storage.sync.get({formData_devUrl:"",formData_devType:"link"},function(e){t.inputUrl=e.formData_devUrl,t.type=e.formData_devType})}},{key:"onFile",value:function(t){var e=this;if(!t)return!1;if(t.size>10485760)return this.$message.warning("请压缩脚本文件在10M以内,尝试外部引用资源文件"),!1;this.fileName=t.name;var n=new FileReader;return n.onloadend=function(t){t.target.readyState==FileReader.DONE&&(e.fileText=t.target.result)},n.readAsText(t,"utf-8"),!1}},{key:"debug",value:function(){var t=Object(st["a"])(regeneratorRuntime.mark(function t(){var e,n,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.fileText,chrome.storage.sync.set({formData_devType:this.type}),"link"!==this.type){t.next=16;break}if(/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i.test(this.inputUrl)){t.next=6;break}return this.$message.error("请输入有效链接"),t.abrupt("return");case 6:return chrome.storage.sync.set({formData_devUrl:this.inputUrl}),this.loadding=!0,t.next=10,$.RMI("fetch",this.inputUrl);case 10:if(n=t.sent,0===n.status){t.next=15;break}return this.loadding=!1,this.$message.error("请输入有效链接"),t.abrupt("return");case 15:e=n.result;case 16:if(e){t.next=20;break}return this.loadding=!1,this.$message.error("无效脚本"),t.abrupt("return");case 20:a={id:"__GLUT_APP_ID__",name:"debug_version",icon:chrome.extension&&chrome.extension.getURL("assets/img/debug.svg")},$.getCurrentTab(function(t){console.log("tab:",t),t.url.startsWith("chrome://")?i.$message.warning("不能在该页面调试小程序"):(i.loadding=!1,chrome.tabs.executeScript(t.id,{code:H(a,e)}),i.$message.success("加载成功"))});case 22:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]);rt=p["a"]([Object(d["a"])({components:{"i-input":h["a"],Radio:et["a"],RadioGroup:tt["a"],Upload:it["a"],Button:m["a"]}})],rt);var ot=rt,ct=ot,lt=(n("ac53"),Object(U["a"])(ct,nt,at,!1,null,"18ea2242",null)),ut=lt.exports,pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dev-form-container flex-column"},[n("div",{staticClass:"info"},[n("div",{staticClass:"form-row flex-row select-app"},[n("div",{staticClass:"label"},[t._v("选择小程序：")]),n("Select",{attrs:{disabled:t.loadding},on:{"on-change":t.changeSelector},model:{value:t.selectApp,callback:function(e){t.selectApp=e},expression:"selectApp"}},[n("Option",{key:"create",staticClass:"app-item flex-row",attrs:{value:"create",label:"新建小程序"}},[n("div",{staticClass:"app-info"},[n("div",{staticClass:"name f-ellipsis"},[t._v("新建小程序")])])]),t._l(t.appList,function(e){return n("Option",{key:e.id,staticClass:"app-item flex-row",attrs:{label:e.name,value:e.id}},[e.icon?n("img",{staticClass:"icon",attrs:{src:e.icon}}):t._e(),n("div",{staticClass:"app-info"},[n("div",{staticClass:"name f-ellipsis"},[t._v(t._s(""+e.name))]),n("div",{staticClass:"desc f-ellipsis"},[t._v(t._s("id: [..."+e.id.slice(-8)+"]"))])])])})],2)],1),n("div",{staticClass:"form-row flex-row"},[n("div",{staticClass:"label"},[t._v("小程序名：")]),n("i-input",{staticClass:"link-input",attrs:{size:"small",placeholder:"请输入小程序名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),n("div",{staticClass:"form-row flex-row nomargin"},[n("div",{staticClass:"label select-script"},[t._v("选择图标：")]),n("Upload",{staticClass:"file-input",attrs:{disabled:t.iconUploadding||t.loadding,"before-upload":t.onIcon,accept:"image/*"}},[n("Button",{attrs:{size:"small",disabled:t.iconUploadding||t.loadding,icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.iconName||"上传小图标(128*128)"))])],1)],1),n("div",{staticClass:"form-row flex-row"},[n("div",{staticClass:"label label-desc"},[t._v("程序介绍：")]),n("i-input",{staticClass:"link-input",attrs:{size:"small",maxlength:"500","show-word-limit":"",type:"textarea"},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}})],1),n("div",{staticClass:"form-row flex-row nomargin"},[n("div",{staticClass:"label select-script"},[t._v("选择脚本：")]),n("Upload",{staticClass:"file-input",attrs:{disabled:t.scriptUploadding||t.loadding,"before-upload":t.onScript,accept:"text/javascript, application/javascript"}},[n("Button",{attrs:{disabled:t.scriptUploadding||t.loadding,size:"small",icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.scriptName||"上传脚本"))])],1)],1),n("div",{staticClass:"form-row flex-row"},[n("div",{staticClass:"label"},[t._v("管理员密码：")]),n("i-input",{staticClass:"link-input",attrs:{size:"small",type:"password",placeholder:"输入管理员密码"},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}})],1)]),n("Button",{attrs:{size:"primary",loading:t.loadding,icon:"md-cloud-upload"},on:{click:t.publish}},[t._v(t._s("create"===t.selectApp?"发布":"更新"))])],1)},dt=[],ft=n("093f"),gt=n("311a"),mt=(n("7514"),function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.scriptName="",t.iconName="",t.iconContent="",t.iconUploadding=!1,t.scriptUploadding=!1,t.scriptContent="",t.pwd="",t.desc="",t.name="",t.loadding=!1,t.selectApp="create",t.appList=[],t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"onIcon",value:function(t){var e=this;if(!t)return!1;if(t.size>25600)return this.$message.warning("请压缩图标在25k以内"),!1;this.iconName=t.name,this.iconContent="",this.iconUploadding=!0;var n=new FileReader;return n.onloadend=function(t){t.target.readyState==FileReader.DONE&&(e.iconContent=t.target.result,e.iconUploadding=!1)},n.readAsDataURL(t),!1}},{key:"onScript",value:function(t){var e=this;if(!t)return!1;if(t.size>10485760)return this.$message.warning("请压缩脚本文件在10M以内,尝试外部引用资源文件"),!1;this.scriptName=t.name,this.scriptContent="",this.scriptUploadding=!0;var n=new FileReader;return n.onloadend=function(t){t.target.readyState==FileReader.DONE&&(e.scriptContent=t.target.result,e.scriptUploadding=!1)},n.readAsText(t,"utf-8"),!1}},{key:"created",value:function(){this.appList=JSON.parse(localStorage.getItem("LIST#APP")||"[]")||[]}},{key:"reset",value:function(){this.iconName="",this.iconContent="",this.scriptContent="",this.scriptName="",this.name="",this.desc=""}},{key:"changeSelector",value:function(t){if(this.reset(),"create"!==t){var e=(this.appList||[]).find(function(e){return e.id===t});e&&(this.name=e.name||"",this.desc=e.desc||"")}}},{key:"publish",value:function(){var t=this;if(this.name)if(this.desc){if(this.pwd)return"create"!==this.selectApp?(this.loadding=!0,void $.RMI("uploadApp","modify",{id:this.selectApp,name:this.name,icon:this.iconContent||"",script:this.scriptContent||"",desc:this.desc||""},this.pwd).then(function(e){var n=e.result;if(t.loadding=!1,console.log("modify result: ",n),n&&0===n.status)return t.reset(),t.$message.success("修改成功"),void $.RMI("updateConfig").then(function(e){0===e.status?t.$message.success("已同步配置"):t.$message.error("加载配置失败")});t.$message.error("修改失败，msg:".concat(n&&n.msg||"none"))})):void(this.iconContent?this.scriptContent?(this.loadding=!0,$.RMI("uploadApp","create",{name:this.name,icon:this.iconContent,script:this.scriptContent,desc:this.desc},this.pwd).then(function(e){var n=e.result;if(t.loadding=!1,console.log("create result: ",n),n&&0===n.status)return t.reset(),t.$message.success("上传成功"),void $.RMI("updateConfig").then(function(e){0===e.status?t.$message.success("已同步配置"):t.$message.error("加载配置失败")});t.$message.error("上传失败,msg:".concat(n&&n.msg||"none"))})):this.$message.error("请上传脚本文件"):this.$message.error("请上传小程序图标"));this.$message.error("请输入管理员密码")}else this.$message.error("请输入小程序描述");else this.$message.error("请输入小程序名称")}},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]));mt=p["a"]([Object(d["a"])({components:{"i-input":h["a"],Upload:it["a"],Button:m["a"],Message:b["a"],Notice:v["a"],Select:gt["a"],Option:ft["a"]}})],mt);var ht=mt,vt=ht,bt=(n("1f07"),Object(U["a"])(vt,pt,dt,!1,null,"f13485d2",null)),yt=bt.exports;chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return""},set:function(t,e){return e()}}});var _t=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.mode="dev",t.groupId="",t.handle=!1,t.appList=[],t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;$.getAppList().then(function(e){t.appList=e}),chrome.storage.sync.get({groupId:""},function(e){t.groupId=e.groupId})}}]),e}(d["b"]);_t=p["a"]([Object(d["a"])({components:{"i-input":h["a"],Radio:et["a"],Icon:L["a"],RadioGroup:tt["a"],devPart:ut,uploadPart:yt}})],_t);var Ct=_t,Ot=Ct,It=(n("d064"),Object(U["a"])(Ot,X,Y,!1,null,null,null)),kt=It.exports,jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting-container"},[!t.showModifyBox&&t.groupId?n("div",{staticClass:"group-id-setting-item setting-item flex-row"},[n("div",{staticClass:"info"},[n("div",{staticClass:"name f-medium"},[t._v(t._s(t.groupName))]),n("div",{staticClass:"desc f-normal"},[t._v("GroupId: "+t._s(t.groupId))])]),n("div",{staticClass:"action f-normal action-modify",on:{click:function(e){t.showModifyBox=!0}}},[t._v("修改GroupId")])]):n("div",{staticClass:"input-box flex-row"},[t.groupId?n("div",{staticClass:"back",on:{click:function(e){t.showModifyBox=!1}}},[t._v("back↩")]):t._e(),n("i-input",{staticClass:"groupid-input",attrs:{icon:"ios-help-circle-outline",placeholder:"请设定GroupId",autocomplete:""},on:{"on-click":t.question},model:{value:t.groupId_edit,callback:function(e){t.groupId_edit=e},expression:"groupId_edit"}}),n("i-button",{attrs:{type:"primary",shape:"circle",loading:t.handle},on:{click:t.confirm}},[t._v("OK")])],1),n("div",{staticClass:"setting-item flex-row"},[t._m(0),n("i-switch",{staticClass:"action",on:{"on-change":t.changeAutoUpdate},model:{value:t.autoUpdate,callback:function(e){t.autoUpdate=e},expression:"autoUpdate"}})],1),n("div",{staticClass:"setting-item flex-row sync-config"},[n("i-button",{staticClass:"bt clear-bt",attrs:{shape:"circle",type:"dashed"},on:{click:t.clearCache}},[t._v("清除缓存")]),n("i-button",{staticClass:"bt",attrs:{shape:"circle",type:"primary",loading:t.syncHandle},on:{click:t.syncSetting}},[t._v("同步配置")])],1)])},wt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info"},[n("div",{staticClass:"name f-medium"},[t._v("自动更新")]),n("div",{staticClass:"desc f-normal"},[t._v("打开浏览器时同步服务端设置")])])}],xt=n("ae14");chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return""},set:function(t,e){return e&&e()}}});var $t=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.groupId_edit="",t.groupId="",t.groupName="",t.autoUpdate=!0,t.showModifyBox=!1,t.handle=!1,t.syncHandle=!1,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;chrome.storage.sync.get({groupId:"",GroupName:"",AutoUpdate:!0},function(e){t.groupId=e.groupId,t.groupId_edit=e.groupId,t.groupName=e.GroupName,t.autoUpdate=e.AutoUpdate})}},{key:"question",value:function(){this.$notice.open({title:"获取GroupId",render:function(t){return t("span",["选择以下方式 ",t("a",{attrs:{href:"https://leelejia.github.io/sites/glut/?page=getId",target:"_blank"}},"通过邮箱查询")," 或 ",t("a",{attrs:{href:"https://leelejia.github.io/sites/glut/?page=regiest",target:"_blank"}},"注册GroupId")," 获取GroupId"])},duration:15e3})}},{key:"syncSetting",value:function(){var t=this;this.syncHandle||(this.syncHandle=!0,$.RMI("updateConfig").then(function(e){t.syncHandle=!1,0===e.status?t.$message.success("更新成功！"):t.$message.error("加载配置失败")}))}},{key:"clearCache",value:function(){localStorage.clear(),chrome.storage.sync.clear(),this.$message.success("已清空缓存!")}},{key:"changeAutoUpdate",value:function(){chrome.storage.sync.set({AutoUpdate:this.autoUpdate})}},{key:"confirm",value:function(){var t=this;if(this.groupId_edit.trim()){if(!this.handle){this.handle=!0;var e=this.$message.loading({content:"同步配置中...",duration:0});$.RMI("updateConfig",this.groupId_edit.trim()).then(function(n){e(),t.handle=!1,t.showModifyBox=!1,0===n.status?(t.$message.success("设置成功！"),chrome.storage.sync.get({groupId:"",GroupName:""},function(e){t.groupId=e.groupId,t.groupName=e.GroupName||""})):t.$message.error(n.result||"请输入有效的GroupId")})}}else this.$message.error("请输入先groupId")}},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]);$t=p["a"]([Object(d["a"])({components:{"i-input":h["a"],"i-button":m["a"],"i-switch":xt["a"]}})],$t);var At=$t,St=At,Pt=(n("9194"),Object(U["a"])(St,jt,wt,!1,null,null,null)),Ut=Pt.exports;chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return""},set:function(t,e){return e()}}});var Nt=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.groupName="apps",t.selectTab="apps",t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){var t=this;chrome.storage.sync.get({GroupName:""},function(e){var n=e.GroupName;t.groupName=n||""})}},{key:"$message",get:function(){return b["a"]}},{key:"$notice",get:function(){return v["a"]}}]),e}(d["b"]);Nt=p["a"]([Object(d["a"])({components:{Menu:D["a"],MenuItem:G["a"],Icon:L["a"],menuApp:Q,menuSetting:Ut,menuDev:kt}})],Nt);var Mt=Nt,Rt=Mt,Tt=(n("e1a5"),Object(U["a"])(Rt,R,T,!1,null,null,null)),Lt=Tt.exports;chrome&&chrome.storage||(chrome.storage={sync:{get:function(){return{groupIdValid:!0}},set:function(t,e){return e()}}});var Gt=function(t){function e(){var t;return Object(r["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.groupIdValid=!0,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"created",value:function(){this.checkGroupId()}},{key:"checkGroupId",value:function(){var t=this;chrome.storage.sync.get({groupIdValid:!1},function(e){t.groupIdValid=e.groupIdValid})}}]),e}(d["b"]);Gt=p["a"]([Object(d["a"])({components:{InputGroupId:M,Panel:Lt}})],Gt);var Dt=Gt,Et=Dt,zt=(n("5c0b"),Object(U["a"])(Et,i,s,!1,null,null,null)),Bt=zt.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(Bt)}}).$mount("#app")},d064:function(t,e,n){"use strict";var a=n("a5d2"),i=n.n(a);i.a},e1a5:function(t,e,n){"use strict";var a=n("42cf"),i=n.n(a);i.a},e332:function(t,e,n){},f04a:function(t,e,n){}});
//# sourceMappingURL=app.6e6e4269.js.map